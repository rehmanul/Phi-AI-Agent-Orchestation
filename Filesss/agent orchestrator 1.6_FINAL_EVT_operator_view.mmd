---
config:
  layout: dagre
  elk:
    nodePlacementStrategy: NETWORK_SIMPLEX
    mergeEdges: true
    padding: 16
---
flowchart TB

%% =====================================================
%% FINAL_EVT OPERATOR VIEW â€” STATE-SPECIFIC FOCUS
%% Purpose: Show only FINAL_EVT-relevant actions/processes
%% Master Reference: .userInput/agent orchestrator 1.6.mmd
%% =====================================================

AVAQ(["ðŸ‘¥ AVAQ Strategic Team"]):::human

subgraph LEGISLATIVE_FINAL["ðŸ“œ FINAL_EVT â€” Vote Imminent"]
direction TB
FINAL_EVT((Vote Imminent)):::decision
FINAL_COAL("Coalition Activation"):::human
FINAL_NARR["Final Constituent Narrative"]:::artifact
end

%% State transitions
FLOOR_EVT((FLOOR_EVT<br/>PREVIOUS STATE)):::system
IMPL_EVT((Law Enacted<br/>NEXT STATE)):::system

FLOOR_EVT -->|State Transition| FINAL_EVT
FINAL_EVT --> FINAL_COAL --> FINAL_NARR -->|State Transition| IMPL_EVT

%% Human involvement
AVAQ --> FINAL_COAL
AVAQ --> HR_RELEASE

%% AI Services supporting FINAL_EVT
subgraph AI_SERVICES_FINAL["ðŸ¤– AI Services â€” FINAL_EVT Support"]
direction TB
AI_GENERATE("ðŸ§  Draft & Strategy Generation"):::ai
end

AI_GENERATE -.-> FINAL_NARR

%% Human Review Gate
subgraph HUMAN_REVIEW_FINAL["ðŸ‘¤ Human Review â€” HR_RELEASE"]
direction TB
HR_RELEASE{Authorize Public Release?}:::decision
end

FINAL_NARR --> HR_RELEASE --o|Blocking| IMPL_EVT

%% Execution Agents (FINAL_EVT scope)
subgraph EXEC_AGENTS_FINAL["âš™ï¸ Execution Agents â€” FINAL_EVT"]
direction TB
EX_COAL("ðŸ¤ Coalition Activation Agent"):::ai
EX_MEDIA("ðŸ“° Media Seeding Agent"):::ai
end

EX_COAL --> EXEC_RUN
EX_MEDIA --> EXEC_RUN

%% Execution Loop
subgraph EXECUTION_LOOP_FINAL["ðŸ”„ Execution Loop â€” FINAL_EVT"]
direction TB
EXEC_STRATEGY("ðŸ§  Strategy Decomposition"):::ai
EXEC_TACTICS("ðŸŽ¯ Tactical Planning"):::ai
EXEC_RUN("âš™ï¸ Tactic Execution Engine"):::system
EXEC_MONITOR("ðŸ“¡ Live Monitoring"):::system
EXEC_RETUNE("ðŸ” Tactical Retuning"):::ai
end

EXEC_STRATEGY --> EXEC_TACTICS --> EXEC_RUN --> EXEC_MONITOR --> EXEC_RETUNE

%% Campaign Operations
subgraph CAMPAIGN_OPS_FINAL["ðŸ”¥ Campaign Operations â€” FINAL_EVT"]
direction TB
THREAD_COALITION("ðŸ§µ Coalition Expansion Sprint"):::system
THREAD_NARRATIVE("ðŸ§µ Narrative Reframing Push"):::system
end

EXEC_RUN --> THREAD_COALITION
EXEC_RUN --> THREAD_NARRATIVE

%% Outbound Influence
subgraph OUTBOUND_FINAL["ðŸ“¤ Outbound Influence â€” FINAL_EVT"]
direction TB
OUT_PARTNER["ðŸ¤ Coalition Partner Activated"]:::artifact
OUT_MEDIA["ðŸ“° Narrative Seeded to Media"]:::artifact
OUT_POINTS["ðŸ—£ï¸ Talking Points Distributed"]:::artifact
end

THREAD_COALITION --> OUT_PARTNER
THREAD_NARRATIVE --> OUT_MEDIA
THREAD_COALITION --> OUT_POINTS

OUT_MEDIA --> EXEC_MONITOR
OUT_PARTNER --> EXEC_MONITOR
OUT_POINTS --> EXEC_MONITOR

%% Memory & Learning
subgraph MEMORY_FINAL["ðŸ—„ï¸ Memory â€” FINAL_EVT"]
direction TB
MEM_OUTCOMES[(ðŸ“ˆ Legislative Outcomes)]:::data
MEM_NARRATIVE[(ðŸ—£ï¸ Narrative Effectiveness Log)]:::data
MEM_TACTICS[(ðŸ“Š Tactic Performance History)]:::data
end

FINAL_EVT --> MEM_OUTCOMES
OUT_MEDIA --> MEM_NARRATIVE
EXEC_MONITOR --> MEM_NARRATIVE

%% Learning Agents
subgraph LEARN_AGENTS_FINAL["ðŸ“ Learning Agents â€” FINAL_EVT"]
direction TB
LR_TACTIC("ðŸ“Š Tactic Performance Learner"):::ai
LR_NARR("ðŸ—£ï¸ Narrative Effectiveness Learner"):::ai
LR_ATTRIB("ðŸ“ˆ Outcome Attribution Agent"):::ai
end

LR_TACTIC --> MEM_TACTICS
LR_NARR --> MEM_NARRATIVE
LR_ATTRIB --> MEM_OUTCOMES

%% Styling Classes
classDef human fill:#E0F2FE,stroke:#0369A1,stroke-width:2px
classDef ai fill:#F3E8FF,stroke:#7C3AED,stroke-width:2px
classDef system fill:#ECFDF5,stroke:#047857,stroke-width:2px
classDef artifact fill:#DBEAFE,stroke:#1E40AF,stroke-width:2px
classDef data fill:#FEF9C3,stroke:#CA8A04,stroke-width:2px
classDef decision fill:#FEE2E2,stroke:#991B1B,stroke-width:2px

%% =====================================================
%% IMPROVED STYLING CLASSES (HIGH CONTRAST)
%% =====================================================

%% Primary (States - High emphasis)
classDef PRIMARY fill:#1E40AF,stroke:#1E3A8A,stroke-width:3px,color:#FFFFFF,font-weight:bold,font-size:14px

%% Human Actions (Review Gates - Urgent attention)
classDef HUMAN_ACTION fill:#FEE2E2,stroke:#DC2626,stroke-width:4px,color:#000000,font-weight:bold,font-size:13px

%% System Flow (AI Services, Execution - Active processes)
classDef SYSTEM_FLOW fill:#DBEAFE,stroke:#2563EB,stroke-width:2.5px,color:#000000,font-size:12px

%% Context Reference (Memory, Learning - Background)
classDef CONTEXT_REF fill:#F3F4F6,stroke:#6B7280,stroke-width:1.5px,stroke-dasharray:5 5,color:#4B5563,font-size:11px,font-style:italic

%% Artifacts (Documents, Outputs)
classDef artifact fill:#E0E7FF,stroke:#6366F1,stroke-width:2px,color:#000000,font-size:12px

%% Data Stores
classDef DATA fill:#FEF3C7,stroke:#F59E0B,stroke-width:2px,color:#000000,font-size:11px

%% Legacy classes (for compatibility)
classDef human fill:#E0F2FE,stroke:#0369A1,stroke-width:2px
classDef ai fill:#F3E8FF,stroke:#7C3AED,stroke-width:2px
classDef system fill:#ECFDF5,stroke:#047857,stroke-width:2px
classDef decision fill:#FEE2E2,stroke:#991B1B,stroke-width:2px
classDef title fill:#FFFFFF,stroke:#000000,stroke-width:2px,font-weight:bold,font-size:16px

%% Apply improved styling
class FLOOR_EVT,IMPL_EVT PRIMARY
class HR_RELEASE,FINAL_EVT HUMAN_ACTION
class AI_GENERATE,EXEC_STRATEGY,EXEC_TACTICS,EXEC_RUN,EXEC_MONITOR,EXEC_RETUNE SYSTEM_FLOW
class MEMORY_FINAL,MEM_OUTCOMES,MEM_NARRATIVE,MEM_TACTICS CONTEXT_REF
class FINAL_NARR,OUT_PARTNER,OUT_MEDIA,OUT_POINTS artifact
class MEM_OUTCOMES,MEM_NARRATIVE,MEM_TACTICS DATA

%% Thick arrows for state transitions
linkStyle 0 stroke:#000000,stroke-width:3px
linkStyle 1 stroke:#000000,stroke-width:3px
